summ_idx,func_idx,func_value
1,1,"{'create_dt': '2023-06-16T13:36:57.198449', 'modified_dt': '2023-06-16T13:36:57.198449'}"
1,2,36
1,3,1
1,4,"(8, 'CREATE TABLE mylib.mytable AS SELECT * FROM sashelp.class;')"
1,5,"LIBNAME mylib 'c:\myfolder';
"
1,6,"%let password = something
"
1,6,"
"
1,6,"* Create a library for our datasets;
"
1,6,"LIBNAME mylib 'c:\myfolder';
"
1,6,"
"
1,6,"* Use PROC SQL with stimer option to track performance;
"
1,6,"options fullstimer;
"
1,6,"PROC SQL STIMER;
"
1,6,"    CREATE TABLE mylib.mytable AS 
"
1,6,"    SELECT * 
"
1,6,"    FROM sashelp.class;
"
1,6,"QUIT;
"
1,6,"
"
1,6,"* Define a macro to summarize a variable;
"
1,6,"%macro summarize_data(lib, data, var);
"
1,6,"    PROC MEANS DATA=&lib..&data;
"
1,6,"        VAR &var;
"
1,6,"    RUN;
"
1,6,"%mend summarize_data;
"
1,6,"
"
1,6,"* Use our macro to summarize Weight in mytable;
"
1,6,"%summarize_data(mylib, mytable, Weight);
"
1,6,"
"
1,6,"* Use a data step to print names to the log;
"
1,6,"DATA _NULL_;
"
1,6,"    SET mylib.mytable;
"
1,6,"    FILE PRINT;
"
1,6,"    PUT 'The name is ' Name;
"
1,6,"RUN;
"
1,6,"
"
1,6,"* Export our dataset to a CSV file;
"
1,6,"PROC EXPORT DATA=mylib.mytable
"
1,6,"    OUTFILE='C:\myfolder\mytable.csv'
"
1,6,"    DBMS=CSV
"
1,6,"    REPLACE;
"
1,6,"RUN;
"
1,7,1
1,8,1
2,1,"{'create_dt': '2023-06-12T15:15:29.947480', 'modified_dt': '2023-06-12T15:15:29.947480'}"
2,2,26
2,3,0
2,5,"LIBNAME mylib 'c:\myfolder';
"
2,6,"%INCLUDE ""test_data/deeper_test_data/sas_script_d1.sas"";
"
2,6,"
"
2,6,"* Create a library for our datasets;
"
2,6,"LIBNAME mylib 'c:\myfolder';
"
2,6,"
"
2,6,"* Define a macro to summarize a variable;
"
2,6,"%macro summarize_data(lib, data, var);
"
2,6,"    PROC MEANS DATA=&lib..&data;
"
2,6,"        VAR &var;
"
2,6,"    RUN;
"
2,6,"%mend summarize_data;
"
2,6,"
"
2,6,"* Use our macro to summarize Height in mytable;
"
2,6,"%summarize_data(mylib, mytable, Height);
"
2,6,"
"
2,6,"* Use a data step to create a log;
"
2,6,"DATA _NULL_;
"
2,6,"    SET mylib.mytable;
"
2,6,"    FILE 'c:\myfolder\log.txt';
"
2,6,"    PUT 'The name is ' Name;
"
2,6,"RUN;
"
2,6,"
"
2,6,"* View the details of our dataset;
"
2,6,"PROC DATASETS LIBRARY=mylib;
"
2,6,"    CONTENTS DATA=mytable;
"
2,6,"QUIT;
"
2,7,0
2,8,1
2,10,"(1, 'test_data/deeper_test_data/sas_script_d1.sas')"
3,1,"{'create_dt': '2023-06-16T13:36:46.030827', 'modified_dt': '2023-06-16T13:36:46.030827'}"
3,2,26
3,3,2
3,4,"(6, 'CONNECT TO ORACLE (USER=your_username PASSWORD=your_password PATH=your_path);')"
3,4,"(14, 'CREATE TABLE mylib.mytable AS SELECT * FROM connection to ORACLE (SELECT * FROM my_oracle_table);')"
3,5,"LIBNAME mylib 'c:\myfolder';
"
3,6,"* Connect to an Oracle database;
"
3,6,"%INCLUDE ""test_data/sas_script_2.sas"";
"
3,6,"
"
3,6,"%let password = fred;
"
3,6,"
"
3,6,"PROC SQL;
"
3,6,"    CONNECT TO ORACLE (USER=your_username PASSWORD=your_password PATH=your_path);
"
3,6,"QUIT;
"
3,6,"
"
3,6,"* Create a library for our datasets;
"
3,6,"LIBNAME mylib 'c:\myfolder';
"
3,6,"
"
3,6,"* Import a dataset from Oracle to our library;
"
3,6,"PROC SQL;
"
3,6,"    CREATE TABLE mylib.mytable AS 
"
3,6,"    SELECT * 
"
3,6,"    FROM connection to ORACLE
"
3,6,"    (SELECT * FROM my_oracle_table);
"
3,6,"QUIT;
"
3,6,"
"
3,6,"* Export our dataset to a CSV file;
"
3,6,"PROC EXPORT DATA=mylib.mytable
"
3,6,"    OUTFILE='C:\myfolder\mytable.csv'
"
3,6,"    DBMS=CSV
"
3,6,"    REPLACE;
"
3,6,"RUN;
"
3,7,1
3,8,0
3,10,"(2, 'test_data/sas_script_2.sas')"
4,1,"{'create_dt': '2023-06-12T09:28:28.429096', 'modified_dt': '2023-06-12T09:28:28.429096'}"
4,2,156
4,3,6
4,4,"(24, 'Select quote(trim(email)) into :To_Email SEPARATED BY "" "" from COMMON.DISTLISTS WHERE Report = \'FSR_Antnem_TX\' AND Status = \'TO\'')"
4,4,"(29, 'Select quote(trim(email)) into :CC_Email SEPARATED BY "" "" from COMMON.DISTLISTS WHERE Report = \'FSR_Anthem_TX\' AND Status = \'CC\'')"
4,4,"(36, 'select ""\'""Irtrim(clientid)II""\'"" into :cProfiles separated by "","" from common.profl where family = &family;')"
4,4,"(83, 'select distinct cats(""\'"",1v11 - acct_gid,""\'"") into :pgid separated by \',\' from dwu _ edw.v _ ems _ trnmt _ dtl as ect where ect.clnt_profl_id in (&cProfiles); select distinct cats(""\'"",1v13_acct_gid,""\'"") into :pgid _3_ separated by \',\' from dwu edw.v ems trnmt dtl as ect where ect.clnt_profl_id in (&cProfiles);')"
4,4,"(95, 'CONNECT TO teradata (database=dwu_edw tdpid=prdedwl user=6.userid password=""&password"" connection=global); CREATE TABLE work.ECA AS SELECT * FROM CONNECTION TO TERADATA /* Encountered*/ Select ECA.LVLl_acctid AS Carrier , ECA.LVL2_acct_id AS acct /* , coalesce(cag.FSR_DESC,\'Unknown\') as family*/ \'â€¢ ENCOUNTERED\' AS Ql Status /* , eca.clmnbr*7 /* , eca.clm_seq_nbr*/ , eca.clm_txn_cd , extract(year from ECA.srvc_dt) as yr , extract(month from ECA.srvc_dt) As mth , SUM(RBL_DUE_AMT) AS dollars ,substr(ect.OUTBD_STRNG_TXT,45,2) AS FAC_Submitted ,eca.LVLl_ACCT_ID ,eca.LVL2_ACCT_ID ,eca.LVL3 ACCT ID FROM DWU_EDW.V_PHMCY CLMEMS_DTL AS ECA inner join DWU_El3W.VMS_TRNMT_DTL AS ECT ON ECA.PRMCY_CLM_kMS_DTL_GID EQ ECT.PHMCY_CLm_EMs_DTL_GID AND ECA.clnt_profl_id in (&cProfiles) AND ECT.clnt_profl_id in (&cProfiles) AND cast(eca.clm_adjn_bgn_ts as date)BETWEEN &xsstart and &xeend AND eca.srvc_dt BETWEEN &xsstartand&xeend AND ect.srvc_dt BETWEEN &xsstartand&xeend AND ECA.selfcrteb2_IND ne \'Y\' AND ECA.clm_txn_cd IN (\'Bl\', \'B2\') AND ECA.src_rec_stus_cd in (\'A\') and eca.clm_typ_cd ne \'R\' and ect.src_hist_curr_cd eq \'C\' and ect.1v13_acct_gid IN (&pgid_3) and ect.lvll_acct_gid IN (&pgid) and eca.1v13_acct_gid IN (&pgid_3) and eca.lvll_acct_gid IN (&pgid) GROUP BY 1,2,3,4,5,6,8,9,10,11 ORDER BY 1,2,3,4,5,6,8,9,10,11 DISCONNECT FROM Teradata;')"
4,4,"(137, ""create table work.eca as select eca.Carrier ,eca.acct ,coalesce(cag.FSR_DESC,'Unknown') as family ,eca.Ql_Status ,eca.clm_txn_cd ,eca.yr ,eca.mth ,sum(eca.dollars) as dollars ,eca.FAC_Submitted from work.eca left join work.anthem_cag_structure as cag on eca.LVLl_ACCT_ID = cag.carrier and eca.LVL2_ACCT_ID = cag.acct and eca.LVL3_acct_id = cag.grp group by 1,2,3,4,5,6,7,9 order by 1,2,3,4,5,6,7,9;"")"
4,5,"LIBNAME DWU_EDW TERADATA SERVER=PRDEDW2 SCHEMA=DWU_EDW_RB DEFER=YES user = &userid password = ""&password"";
"
4,5,"LIBNAME DWU_PRC TERADATA SERVER=PRDEDW2 SCHEMA=DWU_PRC_RB DEFER=YES user = &userid password = ""&password"";
"
4,5,"libname common '/fin_ops/medenc/common';
"
4,5,"LIBNAME mytera TERADATA SERVER=PRDEDW2 user = &userid password = ""&password"" database=sb_mc_enctr;
"
4,6,"%let sasu = %sysfunc(pathname(sasuser));
"
4,6,"%include ""Ifin_ops/medenc/password/password.sas"";
"
4,6,"LIBNAME DWU_EDW TERADATA SERVER=PRDEDW2 SCHEMA=DWU_EDW_RB DEFER=YES user = &userid password = ""&password"";
"
4,6,"LIBNAME DWU_PRC TERADATA SERVER=PRDEDW2 SCHEMA=DWU_PRC_RB DEFER=YES user = &userid password = ""&password"";
"
4,6,"libname common '/fin_ops/medenc/common';
"
4,6,"LIBNAME mytera TERADATA SERVER=PRDEDW2 user = &userid password = ""&password"" database=sb_mc_enctr;
"
4,6,"options validvarname=any;
"
4,6,"proc Datasets lib=work kill memtype=data;
"
4,6,"run;
"
4,6,"%let to_Email = """";
"
4,6,"%let cc_email = ""samuel.Bevilacqua@cvshealth.com"";
"
4,6,"%let family = 'CarelonRx - Elevance TX';
"
4,6,"data _null_;
"
4,6,"call symput Cfamx','FSR'11%sysfunc(Translate(&family,""_"","" "")));
"
4,6,"call symput ('fam2',&family);
"
4,6,"call symput Cfam3',%sysfunc(compress(&family)));
"
4,6,"run;
"
4,6,"%put &famx;
"
4,6,"%put &fam2;
"
4,6,"%put &fam3;
"
4,6,"%let datetime_start = %sysfunc(TIME());
"
4,6,"%LET START_TIME = : %sysfunc(datetime(),datetime14.);
"
4,6,"%put START TIME: %sysfunc(datetime(),datetime14.);
"
4,6,"PROC SQL STIMER;
"
4,6,"Select quote(trim(email)) into :To_Email SEPARATED BY "" "" from COMMON.DISTLISTS
"
4,6,"WHERE Report = 'FSR_Antnem_TX' AND
"
4,6,"Status = 'TO'
"
4,6,"QUIT;
"
4,6,"PROC SQL STIMER;
"
4,6,"Select quote(trim(email)) into :CC_Email SEPARATED BY "" "" from COMMON.DISTLISTS
"
4,6,"WHERE Report = 'FSR_Anthem_TX' AND
"
4,6,"Status = 'CC'
"
4,6,"QUIT;
"
4,6,"%put &to_email;
"
4,6,"%put &cc email;
"
4,6,"proc sql;
"
4,6,"select ""'""Irtrim(clientid)II""'"" into :cProfiles separated by "","" from common.profl where family = &family;
"
4,6,"quit;
"
4,6,"%put ficprofiles;
"
4,6,"%let xsstartems = 01Jan1960;
"
4,6,"%macro setStartDate(intnxToday);
"
4,6,"%if %substr(&intnxToday,3,3) = SEP I
"
4,6,"%substr(&intnxToday,3,3) = OCT I
"
4,6,"%substr(&intnxToday,3,3) = NOV I
"
4,6,"%substr(&intnxToday,3,3) = DEC %then
"
4,6,"%let xsstart_ems = 01Sep%sysfunc(substr(%sysfunc(intnx(year,%sysfunc(today()),-3,b),date9.),6,4),4.);
"
4,6,"%else %let xsztart_ems = 01Sep%sysfunc(substr(%sysfunc(intnx(year,%sysfunc(today()),-4,b),date9.),6,4),4.);
"
4,6,"%mend setStartDate;
"
4,6,"%let startDate = %sysfunc(intnx(month,%sysfunc(today()),0,e),date9.);
"
4,6,"%setStartDate(&startDate.)
"
4,6,"%put &xsstart_ems;
"
4,6,"
"
4,6,"%setStartDate(&startDate.)
"
4,6,"%put &xsstart ems;
"
4,6,"/*%let xeend = 31Aug2020;*/
"
4,6,"%let xeend ems = 01Jan1960;
"
4,6,"%macro setEndDate(intnxToday);
"
4,6,"%if %substr(&intnxToday,3,3) =
"
4,6,"%substr(&intnxToday,3,3) OCT I
"
4,6,"%substr(&intnxToday,3,3) = NOV I
"
4,6,"%substr(&intnxToday,3,3) = DEC %then
"
4,6,"%let xeend ems = 31Aug%sysfunc(substr(%sysfunc(intnx(year,%sysfunc(today()),1,b),date9.),6,4),4.);
"
4,6,"%else %let xeend ems = 31Aug%sysfunc(substr(%sysfunc(intnx(year,%sysfunc(today()),0,b),date9.),6,4),4.);
"
4,6,"%mend setEndDate;
"
4,6,"%let endDate = %sysfunc(intnx(month,%sysfunc(today()),0,e),date9.);
"
4,6,"%setEndDate(&endDate.)
"
4,6,"%put &xeend;
"
4,6,"%let startdatetime = %sysfunc(dhms(""&xsstart_ems""d,0,0,0),datetime.);
"
4,6,"%let enddatetime = %sysfunc(dhms(""&xeend_ems""d,23,59,59),datetime.);
"
4,6,"%let xsstart = %unquote(%str(95')%sysfunc(inputn(&xsstart_ems,date9.),yymmdd10.)%str(%'));
"
4,6,"%let xeend = 95unquote(%str(ir')%sysfunc(inputn(&xeend_ems,date9.),yymmdd10.)%str(V));
"
4,6,"put &xsstart &xsstart ems &xeend &xeend ems &startdatetime &enddatetime;
"
4,6,"/* Set date 2nd time to get the EDw format*/
"
4,6,"*%let xsstart = '2018-09-01';
"
4,6,"*%let xeend = '2020-08-31';
"
4,6,"proc import out=work.anthem_cag_structure
"
4,6,"datafile='/fin_ops/medenc/sassandbox/scripts/FSR/Anthem_CAG_Structure.xlsx'
"
4,6,"dbms=x1sx;
"
4,6,"run;
"
4,6,"proc datasets nolist lib=mytera;
"
4,6,"delete anthem cag structure;
"
4,6,"quit;
"
4,6,"proc Sql stimer noprint;
"
4,6,"select distinct cats(""'"",1v11 - acct_gid,""'"") into :pgid separated by ',' from dwu _ edw.v _ ems _ trnmt _ dtl as ect
"
4,6,"where ect.clnt_profl_id in (&cProfiles);
"
4,6,"select distinct cats(""'"",1v13_acct_gid,""'"") into :pgid _3_ separated by ',' from dwu edw.v ems trnmt dtl as ect
"
4,6,"where ect.clnt_profl_id in (&cProfiles);
"
4,6,"quit;
"
4,6,"%put &pgid &pgid_3;
"
4,6,"
"
4,6,"put &pgid &pgid 3;
"
4,6,"
"
4,6,"
"
4,6,"
"
4,6,"proc Sql;
"
4,6,"CONNECT TO teradata (database=dwu_edw tdpid=prdedwl user=6.userid password=""&password"" connection=global);
"
4,6,"CREATE TABLE work.ECA AS
"
4,6,"SELECT * FROM CONNECTION TO TERADATA
"
4,6,"/* Encountered*/
"
4,6,"Select ECA.LVLl_acctid AS Carrier
"
4,6,", ECA.LVL2_acct_id AS acct
"
4,6,"/* , coalesce(cag.FSR_DESC,'Unknown') as family*/
"
4,6,"'â€¢ ENCOUNTERED' AS Ql Status
"
4,6,"/* , eca.clmnbr*7
"
4,6,"/* , eca.clm_seq_nbr*/
"
4,6,", eca.clm_txn_cd
"
4,6,", extract(year from ECA.srvc_dt) as yr
"
4,6,", extract(month from ECA.srvc_dt) As mth
"
4,6,", SUM(RBL_DUE_AMT) AS dollars
"
4,6,",substr(ect.OUTBD_STRNG_TXT,45,2) AS FAC_Submitted
"
4,6,",eca.LVLl_ACCT_ID
"
4,6,",eca.LVL2_ACCT_ID
"
4,6,",eca.LVL3 ACCT ID
"
4,6,"FROM DWU_EDW.V_PHMCY CLMEMS_DTL AS ECA
"
4,6,"inner join DWU_El3W.VMS_TRNMT_DTL AS ECT
"
4,6,"ON ECA.PRMCY_CLM_kMS_DTL_GID EQ ECT.PHMCY_CLm_EMs_DTL_GID
"
4,6,"AND ECA.clnt_profl_id in (&cProfiles)
"
4,6,"AND ECT.clnt_profl_id in (&cProfiles)
"
4,6,"AND cast(eca.clm_adjn_bgn_ts as date)BETWEEN &xsstart and &xeend
"
4,6,"AND eca.srvc_dt BETWEEN &xsstartand&xeend
"
4,6,"AND ect.srvc_dt BETWEEN &xsstartand&xeend
"
4,6,"AND ECA.selfcrteb2_IND ne 'Y'
"
4,6,"AND ECA.clm_txn_cd IN ('Bl', 'B2')
"
4,6,"AND ECA.src_rec_stus_cd in ('A')
"
4,6,"and eca.clm_typ_cd ne 'R'
"
4,6,"and ect.src_hist_curr_cd eq 'C'
"
4,6,"and ect.1v13_acct_gid IN (&pgid_3)
"
4,6,"and ect.lvll_acct_gid IN (&pgid)
"
4,6,"and eca.1v13_acct_gid IN (&pgid_3)
"
4,6,"and eca.lvll_acct_gid IN (&pgid)
"
4,6,"GROUP BY 1,2,3,4,5,6,8,9,10,11
"
4,6,"ORDER BY 1,2,3,4,5,6,8,9,10,11
"
4,6,"DISCONNECT FROM Teradata;
"
4,6,"quit;
"
4,6,"
"
4,6,"
"
4,6,"proc sql;
"
4,6,"create table work.eca as
"
4,6,"select
"
4,6,"eca.Carrier
"
4,6,",eca.acct
"
4,6,",coalesce(cag.FSR_DESC,'Unknown') as family
"
4,6,",eca.Ql_Status
"
4,6,",eca.clm_txn_cd
"
4,6,",eca.yr
"
4,6,",eca.mth
"
4,6,",sum(eca.dollars) as dollars
"
4,6,",eca.FAC_Submitted
"
4,6,"from work.eca
"
4,6,"left join work.anthem_cag_structure as cag
"
4,6,"on eca.LVLl_ACCT_ID = cag.carrier
"
4,6,"and eca.LVL2_ACCT_ID = cag.acct
"
4,6,"and eca.LVL3_acct_id = cag.grp
"
4,6,"group by 1,2,3,4,5,6,7,9
"
4,6,"order by 1,2,3,4,5,6,7,9;
"
4,6,quit;
4,7,0
4,8,1
4,9,"(74, ['2018-09-01'])"
4,9,"(75, ['2020-08-31'])"
5,1,"{'create_dt': '2023-06-12T15:21:30.504493', 'modified_dt': '2023-06-12T15:21:30.504493'}"
5,2,24
5,3,2
5,4,"(4, 'CONNECT TO ORACLE (USER=your_username PASSWORD=your_password PATH=your_path);')"
5,4,"(12, 'CREATE TABLE mylib.mytable AS SELECT * FROM connection to ORACLE (SELECT * FROM my_oracle_table);')"
5,5,"LIBNAME mylib 'c:\myfolder';
"
5,6,"
"
5,6,"%INCLUDE ""test_data/sas_script_1.sas"";
"
5,6,"
"
5,6,"PROC SQL;
"
5,6,"    CONNECT TO ORACLE (USER=your_username PASSWORD=your_password PATH=your_path);
"
5,6,"QUIT;
"
5,6,"
"
5,6,"* Create a library for our datasets;
"
5,6,"LIBNAME mylib 'c:\myfolder';
"
5,6,"
"
5,6,"* Import a dataset from Oracle to our library;
"
5,6,"PROC SQL;
"
5,6,"    CREATE TABLE mylib.mytable AS 
"
5,6,"    SELECT * 
"
5,6,"    FROM connection to ORACLE
"
5,6,"    (SELECT * FROM my_oracle_table);
"
5,6,"QUIT;
"
5,6,"
"
5,6,"* Export our dataset to a CSV file;
"
5,6,"PROC EXPORT DATA=mylib.mytable
"
5,6,"    OUTFILE='C:\myfolder\mytable.csv'
"
5,6,"    DBMS=CSV
"
5,6,"    REPLACE;
"
5,6,RUN;
5,7,1
5,8,0
5,10,"(2, 'test_data/sas_script_1.sas')"
